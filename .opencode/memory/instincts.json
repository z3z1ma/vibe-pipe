{
  "version": 1,
  "instincts": [
    {
      "id": "optional-type-checking-guard",
      "title": "Use TYPE_CHECKING guard for optional type imports",
      "trigger": "Importing types only for type checking (Schema, DataType) used only in annotations",
      "action": "Import optional types inside TYPE_CHECKING block, import at runtime in else block. This allows module to work without the optional dependency.",
      "tags": [],
      "confidence": 0.8200000000000001,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Optional dependency typing pattern remains a repeated integration concern; worth reinforcing."
        }
      ]
    },
    {
      "id": "baseline-json-storage-pattern",
      "title": "Store reference data as JSON with metadata",
      "trigger": "Implementing historical data storage with timestamp, sample_size, columns for later retrieval",
      "action": "Save data to JSON files with metadata dict (created_at, sample_size, columns, schema_name). Store data list efficiently. Create methods for add, get, get_metadata, list, delete.",
      "tags": [],
      "confidence": 0.75,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "jsonl-append-only-time-series",
      "title": "Use JSONL format for append-only time-series data",
      "trigger": "Storing time-series drift history that only grows",
      "action": "Write each entry as a line to JSONL file (json.dumps(entry) + newline). Efficient append-only, easy to read latest N entries with tail.",
      "tags": [],
      "confidence": 0.72,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "History/time-series persistence patterns continue to prefer append-only JSONL for drift/validation events."
        }
      ]
    },
    {
      "id": "validation-result-wrapper-mapping",
      "title": "Map domain results to ValidationResult format",
      "trigger": "Creating wrapper functions that convert domain types to validation framework ValidationResult",
      "action": "Create wrapper function that takes domain-specific result (DriftResult) and returns ValidationResult (is_valid=alert_level != 'critical', errors=list for critical, warnings=list for recommendations). Map fields appropriately.",
      "tags": [],
      "confidence": 0.7,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "immutable-result-dataclass-frozen",
      "title": "Use @dataclass(frozen=True) for immutable result types",
      "trigger": "Creating result types that should never be modified after creation",
      "action": "Mark result dataclasses with frozen=True to ensure immutability and enable hashability.",
      "tags": [],
      "confidence": 0.65,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "inst-20250129-001",
      "title": "Auto-store validation results in history",
      "trigger": "validation_suite_completed",
      "action": "store_validation_result",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-29T23:36:28.501Z",
      "updated_at": "2026-01-29T23:36:28.501Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:36:28.501Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-002",
      "title": "Initialize database schema for new history stores",
      "trigger": "new_history_store_created",
      "action": "initialize_schema",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:36:28.501Z",
      "updated_at": "2026-01-29T23:36:28.501Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:36:28.501Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-003",
      "title": "Auto-store validation results when suite completes",
      "trigger": "validation_suite_completed",
      "action": "store_validation_result",
      "tags": [],
      "confidence": 0.9,
      "status": "active",
      "created_at": "2026-01-29T23:40:14.274Z",
      "updated_at": "2026-01-29T23:40:14.274Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:40:14.274Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-004",
      "title": "Initialize database schema for new validation history stores",
      "trigger": "new_history_store_created",
      "action": "initialize_schema",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:40:14.274Z",
      "updated_at": "2026-01-29T23:40:14.274Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:40:14.274Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "pandas-string-accessor-error-pattern",
      "title": "Pandas Series.str accessor missing in text cleaning",
      "trigger": "Test failures showing text not cleaned (whitespace not trimmed, case not changed) when using pandas DataFrame operations",
      "action": "When applying string operations to DataFrame columns in pandas 2.x, always use Series.str accessor. Pattern is: df[col].str.trim() or df[col].str.lower(). Never apply string methods directly to column values.",
      "tags": [],
      "confidence": 0.98,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Repeated failures/notes around pandas 2.x string ops; guidance kept emphasizing Series.str usage."
        }
      ]
    },
    {
      "id": "nullable-schema-fields-for-data-with-nones",
      "title": "Set nullable=True on SchemaField when test data contains None values",
      "trigger": "Creating test fixtures with DataRecord objects that will have None/null values in specific fields",
      "action": "When creating SchemaField for any field that might contain None in test data, set nullable=True. DataRecord.__post_init__ raises ValueError if a non-nullable field contains None.",
      "tags": [],
      "confidence": 0.92,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Test fixture/schema nullability noted as a frequent source of ValueError when records contain None."
        }
      ]
    },
    {
      "id": "float-to-int-type-safety-in-outlier-replacement",
      "title": "Handle type mismatch when replacing outliers with mean/median into integer columns",
      "trigger": "Replacing outliers (always float mean/median) into DataFrame columns with integer dtype",
      "action": "Either convert integer column to float before replacement (df[col] = df[col].astype(float)), or explicitly cast mean/median to int (int(mean_val)) when assigning back. Pandas will raise TypeError setting float into int64 Series.",
      "tags": [],
      "confidence": 0.88,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Outlier replacement type mismatch (float statistic into int dtype) called out as a common pitfall to guard for."
        }
      ]
    },
    {
      "id": "drift-baseline-storage-json",
      "title": "Store drift baselines as JSON with metadata",
      "trigger": "Implementing drift detection with historical baseline comparison",
      "action": "Store baseline data as JSON file with metadata (timestamp, sample_size, columns, schema_name). Create BaselineStore class with add_baseline, get_baseline, get_metadata, list_baselines, delete_baseline methods.",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "drift-threshold-validation",
      "title": "Validate drift thresholds on configuration",
      "trigger": "Creating DriftThresholds configuration class",
      "action": "Validate that warning < critical, all thresholds in [0,1] range, and warning < psi_critical, with clear error messages.",
      "tags": [],
      "confidence": 0.75,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "drift-history-timestamp-tracking",
      "title": "Track drift results with timestamps for trend analysis",
      "trigger": "Implementing DriftHistory class for drift monitoring",
      "action": "Store each drift check with timestamp, baseline_id, method, drift_score, and alert_level to enable temporal trend analysis.",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "inst-20260130-001",
      "title": "CompoundSpec v2 skill updates must be full-body",
      "trigger": "Producing a CompoundSpec v2 with skills.update entries",
      "action": "Re-emit the entire final managed body for any skills.update[].body (no snippets/diffs), keep paths repo-root-relative, and include auto/sessionID plus docs.sync if indexes should refresh.",
      "tags": [],
      "confidence": 0.8500000000000001,
      "status": "active",
      "created_at": "2026-01-30T00:15:12.873Z",
      "updated_at": "2026-01-30T03:10:17.032Z",
      "evidence": [
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e"
        },
        {
          "ts": "2026-01-30T01:09:11.730Z",
          "sessionID": "ses_3f39fd14fffe3C00AJzxtXyAqh",
          "note": "This session's autolearn prompt reiterated the mandatory rule: skills.update[].body must re-emit the entire final managed body (no snippets/diffs)."
        },
        {
          "ts": "2026-01-30T03:10:17.032Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Recent autolearn context requires re-emitting full managed bodies for skills.update[].body to avoid invalid partial updates."
        }
      ]
    },
    {
      "id": "avoid-committing-egg-info",
      "title": "Treat egg-info diffs as build artifacts",
      "trigger": "Git diff shows changes under `src/*.egg-info/` (e.g., `PKG-INFO`, `requires.txt`) without intentional packaging/version work",
      "action": "Assume the changes are generated; do not include them in commits/PRs and instead regenerate/clean the working tree via the repo's normal install workflow before re-checking diffs",
      "tags": [],
      "confidence": 0.7,
      "status": "active",
      "created_at": "2026-01-30T00:47:20.149Z",
      "updated_at": "2026-01-30T00:47:20.149Z",
      "evidence": [
        {
          "ts": "2026-01-30T00:47:20.149Z",
          "sessionID": "ses_3f3b9f29dffeLfwiKyS5pJk6x9"
        }
      ]
    },
    {
      "id": "egg-info-churn-is-build-noise",
      "title": "Treat .egg-info diffs as build noise",
      "trigger": "git diff shows only src/vibe_piper.egg-info/* changes (PKG-INFO, SOURCES.txt, requires.txt) with no src/ or tests/ edits",
      "action": "Assume these are generated artifacts; avoid proposing learnings from them and avoid including them in commits unless the repo explicitly tracks egg-info as source of truth.",
      "tags": [],
      "confidence": 0.7,
      "status": "active",
      "created_at": "2026-01-30T01:09:11.730Z",
      "updated_at": "2026-01-30T01:09:11.730Z",
      "evidence": [
        {
          "ts": "2026-01-30T01:09:11.730Z",
          "sessionID": "ses_3f39fd14fffe3C00AJzxtXyAqh"
        }
      ]
    },
    {
      "id": "egg-info-diff-hygiene",
      "title": "Treat src/*.egg-info diffs as generated noise",
      "trigger": "git diff shows changes under src/*.egg-info/ (PKG-INFO, SOURCES.txt, requires.txt) after installs/runs",
      "action": "Assume generated metadata; avoid committing unless intentionally updating packaging. Prefer adding src/*.egg-info/ to .gitignore and cleaning the working tree by removing the generated directories, then re-running only the needed uv commands.",
      "tags": [],
      "confidence": 0.82,
      "status": "active",
      "created_at": "2026-01-30T01:22:03.863Z",
      "updated_at": "2026-01-30T01:22:03.863Z",
      "evidence": [
        {
          "ts": "2026-01-30T01:22:03.863Z",
          "sessionID": "ses_3f39f6b4affegW0YueTnLRJkTJ"
        }
      ]
    },
    {
      "id": "inst-20260130-002",
      "title": "Editable install egg-info noise",
      "trigger": "Git shows changes under src/*.egg-info after running uv editable installs (uv pip install -e .).",
      "action": "Treat src/*.egg-info as generated noise: avoid committing unless intentionally updating packaging metadata; use the existing python-egg-info-hygiene skill to decide whether to ignore, clean, or commit.",
      "tags": [],
      "confidence": 0.8800000000000001,
      "status": "active",
      "created_at": "2026-01-30T01:25:08.462Z",
      "updated_at": "2026-01-30T04:44:58.023Z",
      "evidence": [
        {
          "ts": "2026-01-30T01:25:08.462Z",
          "sessionID": "ses_3f39f6b4affegW0YueTnLRJkTJ"
        },
        {
          "ts": "2026-01-30T03:10:17.032Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Repo workflow uses `uv pip install -e .`; egg-info diffs under src/*.egg-info are common generated noise and should be excluded unless doing packaging work."
        },
        {
          "ts": "2026-01-30T04:44:58.023Z",
          "sessionID": "ses_3f2e8ce06ffevAYdf1gYVcEmzQ",
          "note": "Session diff included multiple src/vibe_piper.egg-info files modified alongside uv.lock changes, matching the pattern that editable installs generate egg-info noise."
        }
      ]
    },
    {
      "id": "compound-state-json-noop",
      "title": "Treat compound state.json diffs as no-op",
      "trigger": "Git summary shows only .opencode/compound/state.json changed",
      "action": "Treat as internal bookkeeping; propose no memory/product changes and avoid suggesting commits or follow-up work based on it.",
      "tags": [],
      "confidence": 0.7,
      "status": "active",
      "created_at": "2026-01-30T02:01:31.629Z",
      "updated_at": "2026-01-30T02:01:31.629Z",
      "evidence": [
        {
          "ts": "2026-01-30T02:01:31.629Z",
          "sessionID": "ses_3f39fcbc8ffesoNca6Upw7Zl97"
        }
      ]
    },
    {
      "id": "loom-docs-merge-conflict-markers",
      "title": "Resolve merge conflict markers in LOOM docs",
      "trigger": "Git diff or file contents show merge conflict markers (<<<<<<<, =======, >>>>>>>) in LOOM_CHANGELOG.md or LOOM_ROADMAP.md (especially inside/near compound-managed fences).",
      "action": "Manually resolve by removing conflict markers, preserving the compound BEGIN/END fences, merging content (often keep both sides but dedupe repeated entries), and ensuring lists remain valid markdown. After resolution, run docs sync to refresh derived indexes/blocks.",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-30T02:25:30.059Z",
      "updated_at": "2026-01-30T02:25:30.059Z",
      "evidence": [
        {
          "ts": "2026-01-30T02:25:30.059Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e"
        }
      ]
    },
    {
      "id": "egg-info-diffs-uv-editable-install",
      "title": "Treat src/*.egg-info diffs as generated noise",
      "trigger": "git diff shows changes under src/*.egg-info (PKG-INFO, SOURCES.txt, requires.txt), often after running `uv pip install -e .` or similar editable install steps",
      "action": "Assume these are generated artifacts; avoid committing them by default. If they are untracked, add src/*.egg-info/ to .gitignore. If they are tracked, only commit them when the project explicitly wants egg-info checked in, and include a clear commit message explaining why.",
      "tags": [],
      "confidence": 0.8200000000000001,
      "status": "active",
      "created_at": "2026-01-30T03:03:55.988Z",
      "updated_at": "2026-01-30T04:44:58.023Z",
      "evidence": [
        {
          "ts": "2026-01-30T03:03:55.988Z",
          "sessionID": "ses_3f333be91ffebe9bPRlChpv8wd"
        },
        {
          "ts": "2026-01-30T04:44:58.023Z",
          "sessionID": "ses_3f2e8ce06ffevAYdf1gYVcEmzQ",
          "note": "Observed egg-info diffs (PKG-INFO/SOURCES.txt/requires.txt) after uv activity; reinforces treating these as generated artifacts."
        }
      ]
    },
    {
      "id": "inst-20260130-003",
      "title": "Plan mode read-only compliance",
      "trigger": "System reminder indicates Plan Mode is ACTIVE / READ-ONLY phase with a prohibition on edits or file-modifying commands.",
      "action": "Do not modify files or run write-effect shell commands; restrict work to reading/inspection tools (Read/Glob/Grep/webfetch) and read-only bash commands (e.g., git status/diff/log). Defer implementation until Plan Mode ends.",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-30T04:28:26.742Z",
      "updated_at": "2026-01-30T04:28:26.742Z",
      "evidence": [
        {
          "ts": "2026-01-30T04:28:26.742Z",
          "sessionID": "ses_3f2e8c84effe1PxTy81Ie7Inm8"
        }
      ]
    }
  ]
}
