{
  "version": 1,
  "instincts": [
    {
      "id": "optional-type-checking-guard",
      "title": "Use TYPE_CHECKING guard for optional type imports",
      "trigger": "Importing types only for type checking (Schema, DataType) used only in annotations",
      "action": "Import optional types inside TYPE_CHECKING block, import at runtime in else block. This allows module to work without the optional dependency.",
      "tags": [],
      "confidence": 0.8200000000000001,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Optional dependency typing pattern remains a repeated integration concern; worth reinforcing."
        }
      ]
    },
    {
      "id": "baseline-json-storage-pattern",
      "title": "Store reference data as JSON with metadata",
      "trigger": "Implementing historical data storage with timestamp, sample_size, columns for later retrieval",
      "action": "Save data to JSON files with metadata dict (created_at, sample_size, columns, schema_name). Store data list efficiently. Create methods for add, get, get_metadata, list, delete.",
      "tags": [],
      "confidence": 0.75,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "jsonl-append-only-time-series",
      "title": "Use JSONL format for append-only time-series data",
      "trigger": "Storing time-series drift history that only grows",
      "action": "Write each entry as a line to JSONL file (json.dumps(entry) + newline). Efficient append-only, easy to read latest N entries with tail.",
      "tags": [],
      "confidence": 0.72,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "History/time-series persistence patterns continue to prefer append-only JSONL for drift/validation events."
        }
      ]
    },
    {
      "id": "validation-result-wrapper-mapping",
      "title": "Map domain results to ValidationResult format",
      "trigger": "Creating wrapper functions that convert domain types to validation framework ValidationResult",
      "action": "Create wrapper function that takes domain-specific result (DriftResult) and returns ValidationResult (is_valid=alert_level != 'critical', errors=list for critical, warnings=list for recommendations). Map fields appropriately.",
      "tags": [],
      "confidence": 0.7,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "immutable-result-dataclass-frozen",
      "title": "Use @dataclass(frozen=True) for immutable result types",
      "trigger": "Creating result types that should never be modified after creation",
      "action": "Mark result dataclasses with frozen=True to ensure immutability and enable hashability.",
      "tags": [],
      "confidence": 0.65,
      "status": "active",
      "created_at": "2026-01-29T23:33:07.624Z",
      "updated_at": "2026-01-29T23:33:07.624Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:33:07.624Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "inst-20250129-001",
      "title": "Auto-store validation results in history",
      "trigger": "validation_suite_completed",
      "action": "store_validation_result",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-29T23:36:28.501Z",
      "updated_at": "2026-01-29T23:36:28.501Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:36:28.501Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-002",
      "title": "Initialize database schema for new history stores",
      "trigger": "new_history_store_created",
      "action": "initialize_schema",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:36:28.501Z",
      "updated_at": "2026-01-29T23:36:28.501Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:36:28.501Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-003",
      "title": "Auto-store validation results when suite completes",
      "trigger": "validation_suite_completed",
      "action": "store_validation_result",
      "tags": [],
      "confidence": 0.9,
      "status": "active",
      "created_at": "2026-01-29T23:40:14.274Z",
      "updated_at": "2026-01-29T23:40:14.274Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:40:14.274Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "inst-20250129-004",
      "title": "Initialize database schema for new validation history stores",
      "trigger": "new_history_store_created",
      "action": "initialize_schema",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:40:14.274Z",
      "updated_at": "2026-01-29T23:40:14.274Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:40:14.274Z",
          "sessionID": "ses_3f421bb4affeONWsqgs3vEW4ZC"
        }
      ]
    },
    {
      "id": "pandas-string-accessor-error-pattern",
      "title": "Pandas Series.str accessor missing in text cleaning",
      "trigger": "Test failures showing text not cleaned (whitespace not trimmed, case not changed) when using pandas DataFrame operations",
      "action": "When applying string operations to DataFrame columns in pandas 2.x, always use Series.str accessor. Pattern is: df[col].str.trim() or df[col].str.lower(). Never apply string methods directly to column values.",
      "tags": [],
      "confidence": 0.98,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Repeated failures/notes around pandas 2.x string ops; guidance kept emphasizing Series.str usage."
        }
      ]
    },
    {
      "id": "nullable-schema-fields-for-data-with-nones",
      "title": "Set nullable=True on SchemaField when test data contains None values",
      "trigger": "Creating test fixtures with DataRecord objects that will have None/null values in specific fields",
      "action": "When creating SchemaField for any field that might contain None in test data, set nullable=True. DataRecord.__post_init__ raises ValueError if a non-nullable field contains None.",
      "tags": [],
      "confidence": 0.92,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Test fixture/schema nullability noted as a frequent source of ValueError when records contain None."
        }
      ]
    },
    {
      "id": "float-to-int-type-safety-in-outlier-replacement",
      "title": "Handle type mismatch when replacing outliers with mean/median into integer columns",
      "trigger": "Replacing outliers (always float mean/median) into DataFrame columns with integer dtype",
      "action": "Either convert integer column to float before replacement (df[col] = df[col].astype(float)), or explicitly cast mean/median to int (int(mean_val)) when assigning back. Pandas will raise TypeError setting float into int64 Series.",
      "tags": [],
      "confidence": 0.88,
      "status": "active",
      "created_at": "2026-01-29T23:52:31.831Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:52:31.831Z",
          "sessionID": "ses_3f421a2b6ffeHWqQsWf7wdrUWl"
        },
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e",
          "note": "Outlier replacement type mismatch (float statistic into int dtype) called out as a common pitfall to guard for."
        }
      ]
    },
    {
      "id": "drift-baseline-storage-json",
      "title": "Store drift baselines as JSON with metadata",
      "trigger": "Implementing drift detection with historical baseline comparison",
      "action": "Store baseline data as JSON file with metadata (timestamp, sample_size, columns, schema_name). Create BaselineStore class with add_baseline, get_baseline, get_metadata, list_baselines, delete_baseline methods.",
      "tags": [],
      "confidence": 0.8,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "drift-threshold-validation",
      "title": "Validate drift thresholds on configuration",
      "trigger": "Creating DriftThresholds configuration class",
      "action": "Validate that warning < critical, all thresholds in [0,1] range, and warning < psi_critical, with clear error messages.",
      "tags": [],
      "confidence": 0.75,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "drift-history-timestamp-tracking",
      "title": "Track drift results with timestamps for trend analysis",
      "trigger": "Implementing DriftHistory class for drift monitoring",
      "action": "Store each drift check with timestamp, baseline_id, method, drift_score, and alert_level to enable temporal trend analysis.",
      "tags": [],
      "confidence": 0.85,
      "status": "active",
      "created_at": "2026-01-29T23:54:28.549Z",
      "updated_at": "2026-01-29T23:54:28.549Z",
      "evidence": [
        {
          "ts": "2026-01-29T23:54:28.549Z",
          "sessionID": "ses_3f423bbacffeOy5Uj6zfY1jYce"
        }
      ]
    },
    {
      "id": "inst-20260130-001",
      "title": "CompoundSpec v2 skill updates must be full-body",
      "trigger": "Producing a CompoundSpec v2 with skills.update entries",
      "action": "Re-emit the entire final managed body for any skills.update[].body (no snippets/diffs), keep paths repo-root-relative, and include auto/sessionID plus docs.sync if indexes should refresh.",
      "tags": [],
      "confidence": 0.75,
      "status": "active",
      "created_at": "2026-01-30T00:15:12.873Z",
      "updated_at": "2026-01-30T00:15:12.873Z",
      "evidence": [
        {
          "ts": "2026-01-30T00:15:12.873Z",
          "sessionID": "ses_3f3c2fef3ffet4DgJC7FV2fb1e"
        }
      ]
    }
  ]
}
