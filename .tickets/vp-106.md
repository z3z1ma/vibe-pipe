---
"id": "vp-106"
"status": "closed"
"deps":
- "vp-101"
"links": []
"created": "2026-01-27T23:30:00Z"
"type": "feature"
"priority": 2
"tags":
- "phase1"
- "error-handling"
"external": {}
---
# Error Handling & Recovery

Improve error handling with retry logic, checkpointing, and recovery.

## Tasks

- Implement retry decorator for assets
- Add checkpoint support in pipelines
- Implement `ErrorStrategy` behaviors (FAIL_FAST, CONTINUE, RETRY)
- Add error context (stack traces, inputs)
- Implement recovery from checkpoints

## Acceptance Criteria

- [ ] Retry decorator works with exponential backoff
- [ ] Checkpoints save state to IO manager
- [ ] Recovery resumes from last checkpoint
- [ ] Error context captured and logged
- [ ] All error strategies work correctly
- [ ] Tests for error scenarios

## Example Usage

```python
@asset(retries=3, backoff="exponential")
def flaky_api_call():
    return fetch_data()
```

## Deliverables

- Retry logic in decorators
- Checkpoint system in execution engine
- Error handling utilities
- Tests

**Priority:** P1 (High)
**Estimate:** 3 days
**Dependencies:** VP-101

## Notes

**2026-01-28T00:54:25Z**

## Implementation Complete

All acceptance criteria met:

✅ Retry decorator works with exponential backoff
✅ Checkpoints save state to IO manager
✅ Recovery resumes from last checkpoint
✅ Error context captured and logged
✅ All error strategies work correctly
✅ Tests for error scenarios (32 tests passing)

### Features Implemented

1. **Retry Logic**
   - Retry decorator with exponential, linear, and fixed backoff strategies
   - Asset-level and engine-level retry configuration
   - Configurable max retries and base delay

2. **Error Context Capture**
   - Detailed error information including stack traces
   - Inputs captured at time of error
   - Attempt numbers and retryable status
   - Serializable error context for logging

3. **Checkpoint System**
   - Automatic checkpoint creation after successful asset execution
   - Checkpoint state management for pipeline runs
   - Can be enabled/disabled per execution engine

4. **Recovery from Checkpoints**
   - Resume execution from last checkpoint
   - Skip already-executed assets
   - Execution plan adjusted based on checkpoint state

5. **Enhanced Error Strategies**
   - FAIL_FAST: Stops immediately on error
   - CONTINUE: Continues execution, collecting all errors
   - RETRY: Retries failed assets with backoff

### Deliverables

- src/vibe_piper/error_handling.py (new module, 400+ lines)
- Enhanced src/vibe_piper/execution.py with checkpointing
- Updated src/vibe_piper/decorators.py with retry support
- Updated src/vibe_piper/__init__.py with exports
- tests/test_error_handling.py (32 comprehensive tests)

### Test Results

All 32 error handling tests passing:
- Retry config tests (6)
- Retry decorator tests (5)
- Error context tests (4)
- Checkpoint tests (3)
- Checkpoint manager tests (7)
- Execution engine retry tests (2)
- Execution engine checkpoint tests (3)
- Error strategy behavior tests (2)

Coverage: 92% for error_handling.py, 74% for execution.py
