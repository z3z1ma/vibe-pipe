---
"id": "vp-f557"
"status": "open"
"deps": []
"links": []
"created": "2026-01-28T01:26:40Z"
"type": "feature"
"priority": 2
"assignee": "z3z1ma"
"tags":
- "phase2"
- "transformations"
- "core"
"external": {}
---
# Transformation Framework

Build comprehensive transformation framework (joins, aggregations, windows) to enable sophisticated data transformations.

## Tasks
1. Implement join operators (inner, left, right, full outer)
2. Implement aggregation operators (groupby, rollup, cube)
3. Implement window functions (row_number, rank, lag, lead)
4. Implement pivot/unpivot operations
5. Create transformation builder API
6. Add type-safe transformation composition
7. Implement schema propagation through transformations

## Example Usage
```python
from vibe_piper import asset, transform
from vibe_piper.transformations import join, groupby, aggregate

@transform
def customer_orders(customers, orders):
    return join(customers, orders, on="customer_id", how="left")

@transform
def daily_sales(orders):
    return (
        orders
        .groupby("date")
        .aggregate(
            total=Sum("amount"),
            count=Count("order_id"),
            avg=Avg("amount")
        )
    )

@transform
def ranked_products(sales):
    return (
        sales
        .window(partition_by="category", order_by="sales desc")
        .rank()
    )
```

## Dependencies
- vp-103 (Validation framework)
- vp-201 (Database connectors)

## Technical Notes
- Use pandas for in-memory transformations
- Use SQL for database-backed transformations
- Maintain schema through transformations
- Support both eager and lazy evaluation
- Optimize for common patterns

## Acceptance Criteria

4 join types working (inner, left, right, full)
Groupby with multiple aggregations
Window functions (row_number, rank, lag, lead)
Pivot/unpivot operations
Builder API for complex transformations
Schema propagation through transformations
Comprehensive tests with edge cases
Documentation with examples
Test coverage > 90%
